<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>MovieLand â€” Legal movie catalog</title>
<style>
:root{--bg:#0f0f12;--card:#121217;--muted:#9aa0a6;--accent:#00b3ff;--maxw:1200px}
*{box-sizing:border-box}body{margin:0;font-family:Inter,Arial,sans-serif;background:var(--bg);color:#fff}
.wrap{max-width:var(--maxw);margin:0 auto;padding:14px}
.header{display:flex;gap:12px;align-items:center;margin-bottom:12px;flex-wrap:wrap}
.brand{font-weight:700;font-size:20px}
.search{flex:1;min-width:200px}
.search input{width:100%;padding:10px;border-radius:8px;border:1px solid #222;background:#0b0b0b;color:#fff}
.lang{display:flex;gap:8px;align-items:center}
.cats{display:flex;gap:8px;flex-wrap:wrap;margin:12px 0}
.cats button{background:#141416;border:1px solid #212226;color:#fff;padding:8px 12px;border-radius:6px;cursor:pointer}
.hero-ad{background:#111;padding:12px;border-radius:8px;text-align:center;margin-bottom:12px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:14px}
.card{background:var(--card);border-radius:10px;overflow:hidden;cursor:pointer;transition:transform .15s}
.card:hover{transform:translateY(-4px)}
.poster{width:100%;height:220px;object-fit:cover;display:block;background:#222}
.title{padding:10px;text-align:center;font-size:15px}
.detail-panel{position:fixed;right:0;top:0;height:100vh;width:0;background:linear-gradient(180deg,#0b0b0d,#111);overflow:auto;z-index:60;transition:width .25s}
.detail-panel.open{width:100%;max-width:920px}
.detail-inner{padding:18px}
.btn{background:#111;border:1px solid #222;color:#fff;padding:8px 12px;border-radius:6px;cursor:pointer}
.section{margin-top:14px;padding:12px;background:#0b0b0b;border-radius:8px}
.ad-slot{background:#17181a;border:2px dashed #2a2a2a;padding:16px;text-align:center;color:var(--muted);border-radius:8px}
@media (max-width:700px){.poster{height:170px}}
</style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div class="brand" id="brand">ðŸŽ¬ MovieLand</div>
      <div class="search"><input id="q" placeholder="Search movies..."></div>
      <div class="lang">
        <select id="lang">
          <option value="az">AZ</option>
          <option value="tr">TR</option>
          <option value="en" selected>EN</option>
        </select>
      </div>
    </div>

    <div class="hero-ad"><div class="ad-slot">Header Ad Slot â€” put AdSense code here later</div></div>

    <div class="cats" id="cats"></div>

    <main><div class="grid" id="grid"></div></main>

    <div style="margin:18px 0"><div class="ad-slot">Inline Ad Slot</div></div>

    <footer style="text-align:center;color:var(--muted);padding:18px">Â© <span id="yr"></span> MovieLand â€” trailers & info</footer>
  </div>

  <aside id="detail" class="detail-panel" aria-hidden="true">
    <div class="detail-inner">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="display:flex;gap:10px;align-items:center">
          <button class="btn" onclick="closeDetail()">Close</button>
          <h3 id="dtitle" style="margin:0"></h3>
        </div>
      </div>

      <div style="margin-top:12px;display:flex;gap:18px;flex-wrap:wrap">
        <img id="dposter" style="width:220px;border-radius:8px" src="" alt="poster">
        <div style="flex:1">
          <h2 id="dname"></h2>
          <p id="ddesc" style="color:var(--muted)"></p>

          <div class="section">
            <h4 data-key="trailer">Trailer</h4>
            <div id="dtrailer" style="margin-top:8px"></div>
          </div>

          <div class="section">
            <h4 data-key="info">Info</h4>
            <p><strong>Year:</strong> <span id="dyear"></span></p>
            <p><strong>Genre:</strong> <span id="dgenre"></span></p>
            <p><strong>IMDB:</strong> <span id="dimdb"></span></p>
          </div>

          <div class="section">
            <h4 data-key="where">Where to Watch</h4>
            <div id="dwhere"></div>
          </div>

          <div class="section">
            <h4 data-key="download">Download / Save</h4>
            <p id="ddownload">Authorized links or placeholder</p>
          </div>

          <div style="margin-top:12px" class="ad-slot">Detail Page Ad Slot</div>
        </div>
      </div>
    </div>
  </aside>

<script>
const yr=document.getElementById('yr'); yr.textContent = new Date().getFullYear();
const grid=document.getElementById('grid'), catsEl=document.getElementById('cats'), q=document.getElementById('q'), langSel=document.getElementById('lang');
let movies = []; // will be loaded from movies.json
let currentLang = localStorage.getItem('lang') || 'en';

/* translation keys for static labels */
const uiTranslations = {
  az:{trailer:'Fragman', info:'MÉ™lumat', where:'Harada izlÉ™mÉ™k', download:'YÃ¼klÉ™'},
  tr:{trailer:'Fragman', info:'Bilgi', where:'Nerede Ä°zlenir', download:'Ä°ndir'},
  en:{trailer:'Trailer', info:'Info', where:'Where to Watch', download:'Download'}
};

function applyStaticLang(){
  document.querySelectorAll('[data-key]').forEach(el=>{
    const k=el.getAttribute('data-key');
    el.textContent = uiTranslations[currentLang][k] || el.textContent;
  });
}

/* load movies.json */
async function loadMovies(){
  try{
    const res = await fetch('./movies.json');
    movies = await res.json();
    buildCategories();
    renderGrid(movies);
    applyStaticLang();
    langSel.value = currentLang;
  }catch(e){
    console.error('Failed loading movies.json', e);
    grid.innerHTML = '<div style="padding:20px;color:var(--muted)">Failed to load movies.json</div>';
  }
}

/* categories */
function buildCategories(){
  const cats = ['all', ...Array.from(new Set(movies.map(m => (m.genre||'Other').toLowerCase())))];
  catsEl.innerHTML='';
  cats.forEach(c=>{
    const b=document.createElement('button');
    b.textContent = c==='all'? (currentLang==='az'?'HamÄ±sÄ±':currentLang==='tr'?'TÃ¼mÃ¼':'All') : capitalize(c);
    b.onclick = ()=>filterBy(c);
    catsEl.appendChild(b);
  });
}

/* grid rendering */
function renderGrid(list){
  grid.innerHTML='';
  list.forEach(m=>{
    const card = document.createElement('div');
    card.className='card';
    const poster = m.poster || '';
    card.innerHTML = `<img class="poster" loading="lazy" src="${poster}" alt="${escapeHtml(m.title[currentLang]||m.title.en)}"><div class="title">${escapeHtml(m.title[currentLang]||m.title.en)}</div>`;
    card.onclick = ()=>openDetail(m.id);
    grid.appendChild(card);
  });
}

/* filter & search */
function filterBy(cat){
  if(cat==='all') renderGrid(movies);
  else renderGrid(movies.filter(m=> (m.genre||'').toLowerCase() === cat ));
}
q.addEventListener('input', ()=> {
  const val = q.value.trim().toLowerCase();
  if(!val) renderGrid(movies);
  else renderGrid(movies.filter(m => (m.title[currentLang]||m.title.en).toLowerCase().includes(val) || (m.desc[currentLang]||m.desc.en||'').toLowerCase().includes(val)));
});

/* detail panel */
const detail = document.getElementById('detail');
function openDetail(id){
  const m = movies.find(x=>x.id===id);
  if(!m) return;
  document.getElementById('dtitle').textContent = m.title[currentLang] || m.title.en;
  document.getElementById('dname').textContent = m.title[currentLang] || m.title.en;
  document.getElementById('ddesc').textContent = m.desc[currentLang] || m.desc.en || '';
  document.getElementById('dposter').src = m.poster || '';
  document.getElementById('dyear').textContent = m.year || '';
  document.getElementById('dgenre').textContent = m.genre || '';
  document.getElementById('dimdb').textContent = m.imdb || '';
  // trailer
  const wrap = document.getElementById('dtrailer');
  if(m.trailer){
    wrap.innerHTML = `<iframe src="${m.trailer}" width="100%" height="360" frameborder="0" allowfullscreen></iframe>`;
  } else {
    wrap.innerHTML = `<p style="color:var(--muted)"><i>No trailer available</i></p>`;
  }
  // where links
  const where = document.getElementById('dwhere');
  where.innerHTML = (m.where||[]).map(w=>`<a href="${w.url}" target="_blank" style="color:var(--accent);margin-right:8px">${escapeHtml(w.name)}</a>`).join('');
  document.getElementById('ddownload').textContent = m.downloadText ? (m.downloadText[currentLang] || m.downloadText.en) : 'â€”';
  detail.classList.add('open'); detail.setAttribute('aria-hidden','false');
  history.pushState({movie:id},'',`#${id}`);
}

/* close */
function closeDetail(){ detail.classList.remove('open'); detail.setAttribute('aria-hidden','true'); if(location.hash) history.pushState(null,'',location.pathname); }

/* helpers */
function capitalize(s){ return s? s.charAt(0).toUpperCase()+s.slice(1):'' }
function escapeHtml(s){ return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;') }

/* language switching */
langSel.addEventListener('change', ()=> {
  currentLang = langSel.value;
  localStorage.setItem('lang', currentLang);
  applyStaticLang();
  renderGrid(movies);
});

/* back/forward handling */
window.addEventListener('popstate', e=> {
  if(e.state && e.state.movie) openDetail(e.state.movie); else closeDetail();
});
window.addEventListener('keydown', e=> { if(e.key==='Escape') closeDetail(); });

/* init */
loadMovies();
</script>
</body>
</html>
